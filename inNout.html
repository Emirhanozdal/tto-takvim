<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Giriş / Yönetim - TTO Takvim</title>
    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            font-family: sans-serif;
            color: #333;
            text-align: center;
        }
        .message {
            display: none; /* JavaScript ile gösterilecek */
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <div id="message-container" class="message">
        <h1>İşlem Tamamlandı</h1>
        <p>Giriş yaptınız. Ana takvim sayfasına dönebilirsiniz.</p>
        <p>Bu pencereyi şimdi kapatabilirsiniz.</p>
    </div>

    <script>
        // Bu script, Netlify panelini yönetir.
        if (window.netlifyIdentity) {
            
            // Panel açıldığında, arkaplanı karart ve mesajı gizle.
            window.netlifyIdentity.on("open", () => {
                document.body.style.backgroundColor = 'rgba(0,0,0,0.4)';
                document.getElementById('message-container').style.display = 'none';
            });

            // Kullanıcı başarıyla GİRİŞ YAPARSA...
            window.netlifyIdentity.on("login", (user) => {
                // ...paneli kapat ve kullanıcıya mesaj göster.
                window.netlifyIdentity.close();
                document.getElementById('message-container').style.display = 'block';
                // Artık YÖNLENDİRME YAPMIYORUZ!
            });

            // Kullanıcı paneli "X" ile KAPATIRSA...
            window.netlifyIdentity.on("close", () => {
                // ...sadece "Bu pencereyi kapatabilirsiniz" mesajını göster.
                const messageContainer = document.getElementById('message-container');
                messageContainer.innerHTML = '<h1>Panel Kapatıldı</h1><p>Bu pencereyi şimdi kapatabilirsiniz.</p>';
                messageContainer.style.display = 'block';
                 // Artık YÖNLENDİRME YAPMIYORUZ!
            });

            // Sayfa ilk yüklendiğinde, giriş yapılmamışsa paneli AÇ.
             window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.open();
                } else {
                    // Kullanıcı zaten giriş yapmışsa, paneli aç ve çıkış yapma seçeneği sun.
                     window.netlifyIdentity.open();
                }
            });
        }
    </script>

</body>
</html>
